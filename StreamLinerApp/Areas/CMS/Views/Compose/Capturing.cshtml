@{
    ViewData["Title"] = "Record ";
}




<partial name="_CMSComposeNav" />
<hr />
<div class="row">
    <div class="col-md-4 p-3 ">
        <button id="startBtn" class="btn btn-outline-info"><i class="fa fa-circle text-danger"></i> Start Recording</button>
        <button id="stopBtn" disabled class="btn btn-outline-info"><i class="fa fa-stop text-secondary"></i> Stop Recording</button>

    </div>
    <div class="col-md-8 p-1">
        <Video id="VideoPlayback" controls style="display:none;"></Video>
    </div>
</div>

<div class="container mt-5">
    <div class="row">

        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 1</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 2</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 3</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 4</p>
        </div>
        <div class="col-md-2 text-center">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 5</p>
        </div>
        <div class="col-md-2 text-center">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 6</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 1</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 2</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 3</p>
        </div>
        <div class="col-md-2 text-center p2">
            <img src="~/img/ico/Video.png" />
            <p class="text-center">File Name 4</p>
        </div>
    </div>

</div>

<script>
    let mediaRecorder;
    let VideoChunks = [];

    document.getElementById("startBtn").onclick = async () => {
        const stream = await navigator.mediaDevices.getUserMedia({ Video: true });
        mediaRecorder = new MediaRecorder(stream);

        mediaRecorder.ondataavailable = e => {
            VideoChunks.push(e.data);
        };

        mediaRecorder.onstop = async () => {
            const blob = new Blob(VideoChunks, { type: 'Video/webm' });
            const formData = new FormData();
            formData.append('VideoFile', blob, 'recording.webm');

            // Playback
            const VideoURL = URL.createObjectURL(blob);
            document.getElementById("VideoPlayback").src = VideoURL;
            document.getElementById("VideoPlayback").style.display = "block";

            // Upload to server
            await fetch('/Video/UploadVideo', {
                method: 'POST',
                body: formData
            });

            VideoChunks = [];
        };

        mediaRecorder.start();
        document.getElementById("startBtn").disabled = true;
        document.getElementById("stopBtn").disabled = false;
    };

    document.getElementById("stopBtn").onclick = () => {
        mediaRecorder.stop();
        document.getElementById("startBtn").disabled = false;
        document.getElementById("stopBtn").disabled = true;
    };
</script>
<br />
<br />

